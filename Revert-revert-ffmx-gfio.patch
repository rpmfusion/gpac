From 5d6f6d42833de953c4831ea974afed82cffa4e0c Mon Sep 17 00:00:00 2001
From: Leigh Scott <leigh123linux@gmail.com>
Date: Tue, 28 Feb 2023 13:46:30 +0000
Subject: [PATCH] Revert "revert ffmx gfio patch"

This reverts commit 70bc8f6877a9651a0fc4c1b14e8cd2bf2f07a068.
---
 src/filters/ff_mx.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/filters/ff_mx.c b/src/filters/ff_mx.c
index 34e5f59e7..96d290177 100644
--- a/src/filters/ff_mx.c
+++ b/src/filters/ff_mx.c
@@ -503,7 +503,7 @@ static GF_Err ffmx_close_seg(GF_Filter *filter, GF_FFMuxCtx *ctx, Bool send_evt_
 		evt.seg_size.is_init = 0;
 	}
 	evt.seg_size.media_range_start = ctx->offset_at_seg_start;
-	evt.seg_size.media_range_end = ctx->muxer->pb ? (ctx->muxer->pb->written-1) : 0;
+	evt.seg_size.media_range_end = ctx->muxer->pb ? (ctx->muxer->pb->bytes_written-1) : 0;
 	ctx->offset_at_seg_start = evt.seg_size.media_range_end;
 
 	gf_filter_pid_send_event(pid, &evt);
-- 
2.39.2

